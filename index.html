<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulateur Comptabilité Artiste-Auteur</title>
<style>
  body { font-family: Arial, sans-serif; background: #1a1a1a; color: #fff; margin:0; padding:20px; }
  h1 { text-align:center; margin-bottom:20px; }
  .card { background: #2a2a2a; padding:20px; border-radius:12px; margin-bottom:20px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
  label { display:block; margin:10px 0 4px; }
  select, input { width: 100%; padding:8px; border-radius:6px; border:none; }
  .result { margin-top:15px; font-size:1.1em; }
  .info-text { font-size:0.9em; color: rgba(255,255,255,0.8); }
</style>
</head>
<body>

<h1>Simulateur Comptabilité Artiste-Auteur</h1>

<div class="card">
  <h2>Paramètres</h2>
  <label for="mode">Mode de calcul</label>
  <select id="mode">
    <option value="jours">Total de jours</option>
    <option value="semaine">Rythme/semaine</option>
  </select>

  <label for="jours">Nombre de jours</label>
  <input type="number" id="jours" value="30" min="1">

  <label for="rythme">Rythme par semaine</label>
  <input type="number" id="rythme" value="5" min="1">

  <label for="mois">Nombre de mois</label>
  <select id="mois">
    <!-- Options générées par JS -->
  </select>

  <label for="avgWeeks">Moyenne semaines par mois</label>
  <input type="number" id="avgWeeks" value="4.333" step="0.001" min="1" max="5">
</div>

<div class="card">
  <h2>Résultats</h2>
  <div class="result">
    <strong>Revenus imposables:</strong> <span id="revenusImposables">0 €</span><br>
    <strong>Net avant impôts:</strong> <span id="netAvantIR">0 €</span><br>
    <strong>Impôt:</strong> <span id="impot">0 €</span><br>
    <strong>Net après impôts:</strong> <span id="netApresIR">0 €</span>
    <div id="netApresExplanation" class="info-text"></div>
  </div>
</div>

<script>
const joursInput = document.getElementById('jours');
const rythmeInput = document.getElementById('rythme');
const modeSelect = document.getElementById('mode');
const moisSelect = document.getElementById('mois');
const avgWeeksInput = document.getElementById('avgWeeks');

const revenusImposablesEl = document.getElementById('revenusImposables');
const netAvantIREl = document.getElementById('netAvantIR');
const impotEl = document.getElementById('impot');
const netApresIREl = document.getElementById('netApresIR');
const explEl = document.getElementById('netApresExplanation');

// Génère options mois
function updateMoisOptions() {
  moisSelect.innerHTML = '';
  for (let i = 1; i <= 12; i++) {
    const opt = document.createElement('option');
    opt.value = i;
    opt.text = i;
    moisSelect.appendChild(opt);
  }
}

// Formate en € avec 0,00
function formatCurrency(val) {
  return val.toLocaleString('fr-FR', { style: 'currency', currency: 'EUR' });
}

// Calcul principal
function updateResults() {
  const jours = parseFloat(joursInput.value) || 0;
  const rythme = parseFloat(rythmeInput.value) || 0;
  const mois = parseFloat(moisSelect.value) || 1;
  const avgWeeks = parseFloat(avgWeeksInput.value) || 4.333;

  // Calcul CA HT
  let caHT = 0;
  if(modeSelect.value === 'jours') {
    caHT = jours * 150; // exemple tarif/jour
  } else {
    caHT = rythme * avgWeeks * mois * 150;
  }

  // Cotisations sociales (~25,5%)
  const cotisations = caHT * 0.255;
  const netAvantIR = caHT - cotisations;

  // Revenus imposables (abattement 34%)
  const revenusImposables = caHT * 0.66;

  // Impôt (taux fictif 13%)
  const impot = revenusImposables * 0.13;

  const netApresIR = netAvantIR - impot;

  // Affichage
  revenusImposablesEl.textContent = formatCurrency(revenusImposables);
  netAvantIREl.textContent = formatCurrency(netAvantIR);
  impotEl.textContent = formatCurrency(impot);
  netApresIREl.textContent = formatCurrency(netApresIR);

  // Explication détaillée
  explEl.innerHTML = `
    Calcul : <strong>Net avant impôts</strong> (${formatCurrency(netAvantIR)}) −
    <strong>Impôt</strong> (${formatCurrency(impot)}) = <strong>${formatCurrency(netApresIR)}</strong>.<br>
    Impôt calculé sur <em>Revenus imposables</em> (${formatCurrency(revenusImposables)}) × 13% = ${formatCurrency(impot)}.
  `;
}

// Événements
[joursInput, rythmeInput, modeSelect, moisSelect, avgWeeksInput].forEach(el => {
  el.addEventListener('input', updateResults);
});

modeSelect.addEventListener('change', () => {
  if(modeSelect.value === 'semaine' || modeSelect.value === 'jours') {
    updateMoisOptions();
  }
  updateResults();
});

// Init
updateMoisOptions();
updateResults();
</script>

</body>
</html>
